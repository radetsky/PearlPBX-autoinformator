#
# Конфигурационный файл для "Катюши". 
#

# Разрешенное время для совершения звонков. 
allowed_time = 9:00-22:00 

# Максимальное количество попыток для одного номера за серию.
max_tries_for_one_destination = 50 

# Описание доступа к asterisk по протоколу Asterisk Manager Interface
<asterisk>
        astManagerHost=10.11.1.5 # 192.168.1.98
	astManagerPort=5039
	astManagerUser=autoinformator
	astManagerSecret=supersecret
	evtManagerUser=eventlistener 
	evtManagerSecret=eventsecret
</asterisk>


# Описание целей. 
# Цель - это совокупность схемы доступа к БД, расчета количества параллельных звонков,
# А так же контекста для возврата. 
<targets> 
	<windication1>                  # Имя цели. Должно быть уникально в пределах одного конфига. 
 		context=callback-connect  # Куда вернуть звонок при успешном дозвоне 
 		maxcalls = auto               # auto - если мы смотрим в очередь на кол-во свободных операторов. Целое от 1 до 120 - если принимает IVR. Параметр обязательный.
		predictive_calls = 4          # нужно ли делать запасные звонки к количеству свободных операторов ?
 		queue = predictive1          # Очередь в которую  надо смотреть для получения кол-ва свободных операторов
 		dsn=dbi:Pg:dbname=asterisk;host=10.11.1.6;port=5432  # DBI-style доступа к БД 
		login=asterisk                # Логин доступа к БД для DBI
		passwd=supersecret            # Пароль доступа к БД для DBI 
 		table=predictive_dialing      # Таблица, где искать данные. Для примера см. sql/autoinformator.sql 
 		where=userfield like '%GROUPNUM=1%'   # Дополнительные условия, по которым надо искать данные для прозвона
 </windication1>
</targets> 

# Маршрутизация звонков для "Катюши".
# Сделана своя собственная по причине тормознутости ответа от Asterisk на команду Originate Local/<exten> 
# Причины сего мне не известны. А если Астериску сказать сразу Originate SIP/<exten>@peer, то ответ придет 
# достаточно быстро, гораздо быстрее чем при обращении через локальный прокси Local/

<routing> 
  <050>
    callerid=0500000000
    trunkgroup=trunkgroup_mobile
  </050>
  <063>
    callerid=0630000000
    trunkgroup=trunkgroup_mobile
 </063>
 <066>
    callerid=0660000000
    trunkgroup=trunkgroup_mobile
 </066>
 <067>
    callerid=0670000000
    trunkgroup=trunkgroup_mobile
 </067>
  <068>
    callerid=0680000000
    trunkgroup=trunkgroup_mobile
 </068>
 <091>
    callerid=0910000000
    trunkgroup=trunkgroup_mobile
 </091>
 <092>
    callerid=0920000000
    trunkgroup=trunkgroup_mobile
 </092>
 <093>
    callerid=0930000000
    trunkgroup=trunkgroup_mobile
 </093>
 <094>
    callerid=0940000000
    trunkgroup=trunkgroup_mobile
 </094>
 <095>
    callerid=0950000000
    trunkgroup=trunkgroup_mobile
 </095>
 <096>
    callerid=0960000000
    trunkgroup=trunkgroup_mobile
 </096>
 <097>
    callerid=0970000000
    trunkgroup=trunkgroup_mobile
 </097>
 <098>
    callerid=0980000000
    trunkgroup=trunkgroup_mobile
 </098>
 <099>
    callerid=0990000000
    trunkgroup=trunkgroup_mobile
 </099>
  <default> # must be 
     callerid=342558769
     trunk=SIP/101
  </default> 
</routing>

#
# Описание транков 
# 
# Если Вы поставили роутинг на транк, а не транкгруппу, то звонки на указанный префикс будут уходить 
# на один транк без какой-либо стратегии. 
# 

<trunk> 
#  SIP/MTS=5                     # Эта строка означает, что для транка SIP/MTS можно использовать максимум 5 каналов
  SIP/GSM1=1 
  SIP/GSM2=1
  SIP/GSM3=1
  SIP/GSM4=1
  SIP/GSM5=1
  SIP/GSM6=1
  SIP/GSM7=1
  SIP/GSM8=1
  SIP/GSM9=1
  SIP/GSM10=1
  SIP/GSM11=1
  SIP/GSM12=1
  SIP/GSM13=1
  SIP/GSM14=1
  SIP/GSM15=1
  SIP/GSM16=1
  SIP/101=30
</trunk> 

#
# Описание транкгрупп 
#
# Транкгруппа - это группа транков (Странно, не правда ли ? :) 
# Лучше чем транк, потому что умеет перебирать каналы по мере их занятости. 
# Стратегия перебора - "по кругу". 
# 

#<trunkgroup1>
#  SIP/GSM1 = 1 									# Эта строка означает, что в именно этой транкгруппе можно использовать только 1 канал для транка SIP/GSM1
#  SIP/GSM2 = 2
##  SIP/MTS = 5 
#</trunkgroup1> 

<trunkgroup>
<trunkgroup_mobile>
  SIP/GSM1=1
  SIP/GSM2=1
  SIP/GSM3=1
  SIP/GSM4=1
  SIP/GSM5=1
  SIP/GSM6=1
  SIP/GSM7=1
  SIP/GSM8=1
  SIP/GSM9=1
  SIP/GSM10=1
  SIP/GSM11=1
  SIP/GSM12=1
  SIP/GSM13=1
  SIP/GSM14=1
  SIP/GSM15=1
  SIP/GSM16=1
</trunkgroup_mobile>
</trunkgroup>

